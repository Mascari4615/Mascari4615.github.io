---
title: "LIS"
# description: ""
categories: [ğŸ’«Computer, ğŸŒ“PS-Algorithm]
tags: [Algorithm, Dynamic-Programming, DP, LIS, Longest-Increasing-Subsequence]
image: "/assets/img/background/kururu-lab.jpg"

date: 2024-11-13. 01:24
# last_modified_at: 2024-11-13. 01:24 # Init
last_modified_at: 2024-11-16. 05:53 # N Log N
---

## ğŸ’« LIS

---

Longest Increasing Subsequence | ìµœì¥ ì¦ê°€ ë¶€ë¶„ ìˆ˜ì—´  

DPë¡œ í’€ ìˆ˜ ìˆëŠ” ë¬¸ì œ.  
ìˆ˜ì—´ì—ì„œ ê°€ì¥ ê¸´ ì¦ê°€ ë¶€ë¶„ ìˆ˜ì—´ì„ ì°¾ëŠ” ë¬¸ì œ.  

### ğŸ«§ ìš©ì–´ ì •ë¦¬

**ë¶€ë¶„ ìˆ˜ì—´**  
= ìˆ˜ì—´ì˜ ì›ì†Œ ì¤‘ ì¼ë¶€ë¥¼ ì„ íƒí•´ì„œ(í˜¹ì€ ì œê±°í•´ì„œ) ë§Œë“  ìˆ˜ì—´  
i.e. `1 2 3 4`ì—ì„œ `1 3 4`, `2 4` ë“±  

**ì¦ê°€ ë¶€ë¶„ ìˆ˜ì—´**  
= ì˜¤ë¦„ì°¨ìˆœìœ¼ë¡œ ì •ë ¬ëœ ë¶€ë¶„ ìˆ˜ì—´  
i.e. `1 2 3 4`, `3 5 7 9` ë“±  

**ìµœì¥ ì¦ê°€ ë¶€ë¶„ ìˆ˜ì—´**  
= ê°€ì¥ ê¸´ ì¦ê°€ ë¶€ë¶„ ìˆ˜ì—´  

## ğŸ’« ì•Œê³ ë¦¬ì¦˜

---

![LIS](/assets/img/post/2024/241113_223106.png)

### ğŸ«§ O(N^2)

```cs
const int MX = 1005;
int a[MX];
int d[MX];

int main()
{
	int n;
	cin >> n;

	for (int i = 1; i <= n; i++)
		cin >> a[i];

	int mxLen = 0;
	for (int i = 1; i <= n; i++)
	{
		int curA = a[i];
		int curDMax = 0;

		for (int j = 0; j < i; j++)
		{
			int tarA = a[j];
			int tarD = d[j];

			if (tarA < curA)
				if (tarD >= curDMax)
					curDMax = tarD;
		}

		d[i] = curDMax + 1;
		mxLen = max(mxLen, d[i]);
	}

	cout << mxLen;
}
```

```cpp
int n;
cin >> n;

vector<int> a(n);
vector<int> d(n);

for (int i = 0; i < n; i++)
	cin >> a[i];

for (int i = 0; i < n; i++)
{
	d[i] = 1;
	
	for (int j = 0; j < i; j++)
		if (a[j] < a[i] && d[i] < d[j] + 1)
			d[i] = d[j] + 1;
}

cout << *max_element(d.begin(), d.end());
```

### ğŸ«§ O(N log N)

O(N^2) ë°©ë²•ì„ ìµœì í™”í•˜ì—¬ O(N log N)ìœ¼ë¡œ ë§Œë“¤ ìˆ˜ ìˆë‹¤.  

O(N^2) ë°©ë²•ì€ í•´ë‹¹ ì‹œì ì—ì„œ ê°€ì¥ ê¸´ ì¦ê°€ ë¶€ë¶„ ìˆ˜ì—´ì˜ ê¸¸ì´ë¥¼ ê³„ì‚°í•˜ê³  ê°±ì‹ í•˜ëŠ” ë°©ì‹ì´ë¼ë©´,  
O(N log N) ë°©ë²•ì€ í•´ë‹¹ ì‹œì ì—ì„œ ë§Œë“¤ ìˆ˜ ìˆëŠ” ê°€ì¥ ê¸´ ì¦ê°€ ë¶€ë¶„ ìˆ˜ì—´ì„ **ìì²´**ë¥¼ ë§Œë“¤ì–´ ê°±ì‹ í•˜ëŠ” ë°©ì‹ì´ë‹¤.  

ì´ì§„ íƒìƒ‰ (lower_bound)ë¥¼ ì´ìš©í•˜ì—¬,  
í•´ë‹¹ ì‹œì ì— ë§Œë“¤ì–´ì§„ ì¦ê°€ ë¶€ë¶„ ìˆ˜ì—´ì˜ ë§ˆì§€ë§‰ ê°’ë³´ë‹¤ í° ê°’ì´ ë‚˜ì˜¤ë©´ ê·¸ ê°’ì„ ì¶”ê°€í•˜ê³ ,  
ì‘ì€ ê°’ì´ ë‚˜ì˜¤ë©´ lower_boundë¡œ ì‘ì€ ê°’ì´ ëŒ€ì²´í•  ìˆ˜ ìˆëŠ” ìœ„ì¹˜ë¥¼ ì°¾ì•„ ëŒ€ì²´í•œë‹¤.  

(ë­”ê°€ ì„¤ëª…ì´ ì§ê´€ì ì´ì§„ ì•Šë‹¤. ê¹Œë¨¹ì—ˆë‹¤ë©´ ì½”ë“œ ë³´ë©´ì„œ ì´í•´í•  ê²ƒ.)  

```cpp
int n;
cin >> n;

vector<int> a(n);
for (int i = 0; i < n; i++)
	cin >> a[i];

// í•´ë‹¹ ì‹œì ì—ì„œ ë§Œë“¤ ìˆ˜ ìˆëŠ” ê°€ì¥ ê¸´ ì¦ê°€ ë¶€ë¶„ ìˆ˜ì—´, ê·¸ ì¤‘ì—ì„œ ìš”ì†Œë“¤ì˜ ê°’ì´ ê°€ì¥ ì‘ì€ ìˆ˜ì—´ì„ ë§Œë“¤ì–´ ë‚˜ê°„ë‹¤.
vector<int> lis;
for (int i = 0; i < n; i++)
{
	// ì´ì§„ íƒìƒ‰ìœ¼ë¡œ a[i]ë³´ë‹¤ í¬ê±°ë‚˜ ê°™ì€ ê°’ì´ ìˆëŠ”ì§€ í™•ì¸ (ê·¸ ì¤‘ ê°€ì¥ ì™¼ìª½ì— ìˆëŠ” ê°’)
	// ì—¬ê¸°ì„œëŠ” ì¼ë‹¨ a[i]ë³´ë‹¤ í° ê°’ì„ ì°¾ê³ , ê·¸ê±¸ a[i] ëŒ€ì²´í•˜ê³  ì‹¶ë‹¤ëŠ” ìƒê°
	auto it = lower_bound(lis.begin(), lis.end(), a[i]);

	// ì—†ìœ¼ë©´ ë’¤ì— ì¶”ê°€
	if (it == lis.end())
	{
		lis.push_back(a[i]);
	}
	// ìˆìœ¼ë©´ ê·¸ ê°’ì„ a[i]ë¡œ êµì²´
	else
	{
		*it = a[i];

		// êµì²´í•˜ëŠ” ì´ìœ ëŠ” ì „ì²´ì ìœ¼ë¡œ ìš”ì†Œë“¤ì˜ ê°’ì´ ì‘ì•„ì•¼ ë‚˜ì¤‘ì— ë” ê¸´ ì¦ê°€ ë¶€ë¶„ ìˆ˜ì—´ì„ ë§Œë“¤ ìˆ˜ ìˆëŠ” ê°€ëŠ¥ì„±ì´ ë†’ì•„ì§€ê¸° ë•Œë¬¸
		
		// ì˜ˆë¥¼ ë“¤ì–´ 5 1 2ë¼ëŠ” ìˆ˜ì—´ì—ì„œ, ê° ìš”ì†Œë¥¼ ìˆœíšŒí•˜ë©° LISë¥¼ êµ¬í•œë‹¤ê³  ê°€ì •
		// 5ê¹Œì§€ ìˆœíšŒë¥¼ í•˜ê³ , (í˜„ì¬ LISëŠ” {5})
		// 1ë¥¼ ìˆœíšŒí•˜ëŠ” ì°¨ë¡€ì—ì„œ,
		
		// 5ë¥¼ 1ë¡œ ë°”ê¿”ë„ ì–´ì°¨í”¼ ê¸¸ì´ëŠ” ë˜‘ê°™ë‹¤ê³  5ë¥¼ ê·¸ëŒ€ë¡œ ë‘ë©´ ìµœì¢…ì ìœ¼ë¡œ LISë¥¼ {5}ë¡œ ë§Œë“¤ ìˆ˜ ë°–ì— ì—†ë‹¤.
		// ì™œëƒí•˜ë©´ 2ëŠ” 5ë³´ë‹¤ ì‘ì•„ì„œ ëª» ë“¤ì–´ê°€ë‹ˆê¹Œ.
		
		// ë§Œì•½ 5ë¥¼ 1ë¡œ ë°”ê¿¨ë‹¤ë©´, {1}ë¡œ ì‹œì‘í•˜ëŠ” LISë¥¼ ë§Œë“¤ ìˆ˜ ìˆê³ 
		// ê·¸ ë‹¤ìŒ 2ë¥¼ ìˆœíšŒí•˜ëŠ” ì°¨ë¡€ì—ì„œ, {1}ì— 2ë¥¼ ì¶”ê°€í•˜ë©´ {1, 2}ë¡œ LISë¥¼ ë§Œë“¤ ìˆ˜ ìˆë‹¤.
	}
}

cout << lis.size();
```

ì£¼ì„ ì—†ëŠ” ì½”ë“œ.  

```cpp
int n;
cin >> n;

vector<int> a(n);
for (int i = 0; i < n; i++)
	cin >> a[i];

vector<int> lis;
for (int i = 0; i < n; i++)
{
	auto it = lower_bound(lis.begin(), lis.end(), a[i]);
	if (it == lis.end())
	{
		lis.push_back(a[i]);
	}
	else
	{
		*it = a[i];
	}
}

cout << lis.size();
```

## ğŸ’« ê¸°ë¡

---

- [ì°¸ê³  : 'ë‚˜ë¬´ìœ„í‚¤ - ìµœì¥ ì¦ê°€ ë¶€ë¶„ ìˆ˜ì—´'](https://namu.wiki/w/ìµœì¥%20ì¦ê°€%20ë¶€ë¶„%20ìˆ˜ì—´)  

## ğŸ’« ë¬¸ì œ

---

- [ë¬¸ì œì§‘](https://www.acmicpc.net/workbook/view/5079)
  - [X] [ê°€ì¥ ê¸´ ì¦ê°€í•˜ëŠ” ë¶€ë¶„ ìˆ˜ì—´ (11053)](https://www.acmicpc.net/problem/11053)
  - [X] [ê°€ì¥ ê¸´ ì¦ê°€í•˜ëŠ” ë¶€ë¶„ ìˆ˜ì—´ 2 (12015)](https://www.acmicpc.net/problem/12015)
  - [ ] [ê°€ì¥ ê¸´ ì¦ê°€í•˜ëŠ” ë¶€ë¶„ ìˆ˜ì—´ 3 (12738)](https://www.acmicpc.net/problem/12738)
  - [X] [ê°€ì¥ ê¸´ ì¦ê°€í•˜ëŠ” ë¶€ë¶„ ìˆ˜ì—´ 4 (14002)](https://www.acmicpc.net/problem/14002)
  - [ ] [ê°€ì¥ ê¸´ ì¦ê°€í•˜ëŠ” ë¶€ë¶„ ìˆ˜ì—´ 5 (14003)](https://www.acmicpc.net/problem/14003)
  - [ ] [ê°€ì¥ ê¸´ ì¦ê°€í•˜ëŠ” ë¶€ë¶„ ìˆ˜ì—´ 6 (17411)](https://www.acmicpc.net/problem/17411)
  - [ ] [ê°€ì¥ ê¸´ ì¦ê°€í•˜ëŠ” ë¶€ë¶„ ìˆ˜ì—´ K (18837)](https://www.acmicpc.net/problem/18837)
  - [ ] [ê°€ì¥ ê¸´ ì¦ê°€í•˜ëŠ” ë¶€ë¶„ ìˆ˜ì—´ k (18838)](https://www.acmicpc.net/problem/18838)
  - [ ] [ê°€ì¥ ê¸´ ì¦ê°€í•˜ëŠ” ë¶€ë¶„ ìˆ˜ì—´ ks (18892)](https://www.acmicpc.net/problem/18892)
  - [X] [ê°€ì¥ í° ì¦ê°€í•˜ëŠ” ë¶€ë¶„ ìˆ˜ì—´ (11055)](https://www.acmicpc.net/problem/11055)
  - [X] [ê°€ì¥ í° ê°ì†Œ ë¶€ë¶„ ìˆ˜ì—´ (17216)](https://www.acmicpc.net/problem/17216)
  - [X] [ê°€ì¥ ê¸´ ë°”ì´í† ë‹‰ ë¶€ë¶„ ìˆ˜ì—´ (11054)](https://www.acmicpc.net/problem/11054)
  - [X] [ê°€ì¥ ê¸´ ê°ì†Œí•˜ëŠ” ë¶€ë¶„ ìˆ˜ì—´ (11722)](https://www.acmicpc.net/problem/11722)
  - [ ] [ê°€ì¥ ê¸´ ì¦ê°€í•˜ëŠ” íŒ°ë¦°ë“œë¡¬ ë¶€ë¶„ìˆ˜ì—´ (16161)](https://www.acmicpc.net/problem/16161)
